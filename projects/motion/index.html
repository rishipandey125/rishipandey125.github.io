
<!DOCTYPE html>
<html lang="en">
	<head>
		<title>motion</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
	</head>
	<body>

		
		<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.js"></script>

		<script type="module">
			import { ARButton } from 'https://cdn.jsdelivr.net/npm/three@0.146.0/examples/jsm/webxr/ARButton.js';
			let scene; 
			let camera;
			let renderer;
			let cube;
			let controller;

			let startScale = getRandomInt(4);
			let endScale = getRandomInt(4);
			let startColor = new THREE.Color(Math.random(),Math.random(),Math.random())
			let endColor = new THREE.Color(Math.random(),Math.random(),Math.random())

			let numFrames = 0 
			function getRandomInt(max) {
				return Math.ceil(Math.random() * max);
			}

			function easeOutCirc(x) {
				return Math.sqrt(1 - Math.pow(x - 1, 2));
			}

			function mix(a,b,val) {
				let alpha = easeOutCirc(val)
				return a + (b-a)*alpha;
			}

			function mixColor(col1,col2,val) {
				let alpha = easeOutCirc(val)
				let r = mix(col1.r,col2.r,val);
				let g = mix(col1.g,col2.g,val);
				let b = mix(col1.b,col2.b,val);
				return new THREE.Color(r,g,b);
			}

			// function easingCurves(index,a,b,val) {
				
			// }

			init();
			animate();
			function init() {
				scene = new THREE.Scene();
				camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000 );

				renderer = new THREE.WebGLRenderer( { antialias: true, alpha: true} );
				renderer.setSize( window.innerWidth, window.innerHeight );
				renderer.xr.enabled = true
				document.body.appendChild( renderer.domElement );

				document.body.appendChild( ARButton.createButton( renderer ) );

				const geometry = new THREE.BoxGeometry( 1, 1, 1 );
				const material = new THREE.MeshBasicMaterial( { color: '#ffffff'} )
				
				material.color = new THREE.Color(1,0,0);

				cube = new THREE.Mesh( geometry, material );
				scene.add( cube );

				controller = renderer.xr.getController( 0 );
				// controller.addEventListener( 'selectstart', onSelectStart );
				// controller.addEventListener( 'selectend', onSelectEnd );
				controller.userData.skipFrames = 0;
				
				scene.add( controller );

				camera.position.z = 5;
			}

			function animate(time) {
				renderer.setAnimationLoop( animate );

				numFrames += 1

				let alpha = numFrames / 100;

				cube.scale.x = mix(startScale,endScale,alpha);
				// cube.scale.y = mix(startScale,endScale,alpha);
				// cube.scale.z = mix(startScale,endScale,alpha);

				cube.material.color = mixColor(startColor,endColor,alpha);

				if (alpha == 1) {
					numFrames = 0
					startScale = endScale 
					endScale = getRandomInt(4)
					startColor = endColor
					endColor = new THREE.Color(Math.random(),Math.random(),Math.random())
				}

				// console.log(numFrames)
				cube.rotation.x += 0.003;
				cube.rotation.y += 0.003;
				cube.rotation.z += 0.003;


				if (renderer.xr.isPresenting) {
					renderer.alpha = true
				}

				renderer.render( scene, camera );
			};

		</script>
	</body>
</html>